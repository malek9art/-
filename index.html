<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مالك أرت | إبداع يتجاوز التوقعات</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        /* أنماط CSS الأساسية هنا (نفس المحتوى السابق) */
        :root {
            --dark-blue: #272f4e;
            --gold: #e1a02b;
            --white: #FFFFFF;
            --light-gray: #f8f9fa;
            --dark-gray: #2d3436;
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }
        
        /* ... باقي الأنماط ... */
    </style>
</head>
<body>
    <!-- محتوى HTML هنا (نفس المحتوى السابق) -->

    <script>
        // كود JavaScript مصحح ومدمج
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== بدء تحميل موقع مالك أرت ===');
            
            // 1. تهيئة البيانات
            function initializeSiteData() {
                if (!localStorage.getItem('malekArtData')) {
                    const initialData = {
                        portfolio: [
                            {
                                id: 1,
                                title: "هوية بصرية متكاملة",
                                description: "تصميم هوية بصرية لمطعم راقي",
                                image: "https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80"
                            },
                            // ... باقي البيانات ...
                        ],
                        // ... باقي البيانات ...
                    };
                    localStorage.setItem('malekArtData', JSON.stringify(initialData));
                }
                return JSON.parse(localStorage.getItem('malekArtData'));
            }

            // 2. تحميل المحتوى
            function loadContent() {
                const data = initializeSiteData();
                // ... تحميل المحتوى ...
            }

            // 3. نظام المصادقة - الإصدار المصحح
            const ADMIN_CREDENTIALS = {
                username: 'm711kart',
                password: 'Ma775672439#'
            };

            function updateLoginDropdownText() {
                const loginDropdownLink = document.getElementById('login-dropdown-link');
                const dashboardLink = document.getElementById('dashboard-link');
                const isLoggedIn = localStorage.getItem('malekArtLoggedIn') === 'true';
                
                if (loginDropdownLink) {
                    loginDropdownLink.innerHTML = isLoggedIn ? 
                        '<i class="fas fa-sign-out-alt"></i> تسجيل الخروج' : 
                        '<i class="fas fa-sign-in-alt"></i> تسجيل الدخول';
                }
                
                if (dashboardLink) {
                    dashboardLink.style.display = isLoggedIn ? 'block' : 'none';
                }
            }

            function initLoginDropdown() {
                const loginDropdownLink = document.getElementById('login-dropdown-link');
                if (loginDropdownLink) {
                    loginDropdownLink.onclick = function(e) {
                        e.preventDefault();
                        const isLoggedIn = localStorage.getItem('malekArtLoggedIn') === 'true';
                        
                        if (isLoggedIn) {
                            if (confirm('هل تريد تسجيل الخروج؟')) {
                                localStorage.removeItem('malekArtLoggedIn');
                                updateLoginDropdownText();
                                document.getElementById('adminDashboard').style.display = 'none';
                                alert('تم تسجيل الخروج بنجاح');
                            }
                        } else {
                            document.getElementById('adminLoginModal').style.display = 'flex';
                        }
                    };
                }
                updateLoginDropdownText();
            }

            function login(username, password) {
                if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                    localStorage.setItem('malekArtLoggedIn', 'true');
                    updateLoginDropdownText();
                    
                    // إغلاق نافذة التسجيل وفتح لوحة التحكم
                    document.getElementById('adminLoginModal').style.display = 'none';
                    document.getElementById('adminDashboard').style.display = 'block';
                    
                    // تحميل محتوى لوحة التحكم
                    loadAdminPanel();
                    
                    alert('تم تسجيل الدخول بنجاح!');
                    return true;
                }
                alert('اسم المستخدم أو كلمة المرور غير صحيحة!');
                return false;
            }

            // 4. لوحة التحكم
            function loadAdminPanel() {
                const data = JSON.parse(localStorage.getItem('malekArtData'));
                // ... تحميل محتوى لوحة التحكم ...
            }

            function initAdminPanel() {
                // إعداد event listeners للوحة التحكم
                document.getElementById('adminLoginBtn').onclick = function() {
                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;
                    login(username, password);
                };

                document.getElementById('adminCloseBtn').onclick = function() {
                    document.getElementById('adminLoginModal').style.display = 'none';
                };

                document.getElementById('adminDashboardClose').onclick = function() {
                    document.getElementById('adminDashboard').style.display = 'none';
                };

                // إعداد tabs لوحة التحكم
                const tabs = document.querySelectorAll('.admin-tab');
                tabs.forEach(tab => {
                    tab.onclick = function() {
                        tabs.forEach(t => t.classList.remove('active'));
                        this.classList.add('active');
                        
                        document.querySelectorAll('.admin-content').forEach(content => {
                            content.classList.remove('active');
                        });
                        
                        const tabId = this.getAttribute('data-tab');
                        document.getElementById(`${tabId}Content`).classList.add('active');
                    };
                });

                // إعداد أزرار الإضافة
                document.getElementById('addPortfolioBtn').onclick = addPortfolioItem;
                document.getElementById('addServiceBtn').onclick = addServiceItem;
                document.getElementById('addTestimonialBtn').onclick = addTestimonialItem;
                document.getElementById('saveContactBtn').onclick = saveContactInfo;
            }

            // 5. وظائف الإضافة والحذف
            function addPortfolioItem() {
                const title = document.getElementById('portfolioTitle').value;
                const description = document.getElementById('portfolioDesc').value;
                const image = document.getElementById('portfolioImage').value;
                
                if (!title || !description || !image) {
                    alert('يرجى ملء جميع الحقول');
                    return;
                }
                
                const data = JSON.parse(localStorage.getItem('malekArtData'));
                const newId = data.portfolio.length > 0 ? Math.max(...data.portfolio.map(item => item.id)) + 1 : 1;
                
                data.portfolio.push({ id: newId, title, description, image });
                localStorage.setItem('malekArtData', JSON.stringify(data));
                
                loadContent();
                loadAdminPanel();
                alert('تم إضافة العمل بنجاح');
            }

            // 6. تهيئة الموقع
            function initWebsite() {
                initializeSiteData();
                loadContent();
                initLoginDropdown();
                initAdminPanel();
                
                console.log('تم تهيئة الموقع بنجاح');
            }

            // بدء التهيئة
            initWebsite();

            // إضافة أزرار اختبار للمساعدة في التصحيح
            const testBtn = document.createElement('button');
            testBtn.textContent = 'اختبار التسجيل';
            testBtn.style.position = 'fixed';
            testBtn.style.top = '10px';
            testBtn.style.left = '10px';
            testBtn.style.zIndex = '10000';
            testBtn.style.padding = '10px';
            testBtn.style.background = '#e74c3c';
            testBtn.style.color = 'white';
            testBtn.style.border = 'none';
            testBtn.style.borderRadius = '5px';
            testBtn.onclick = function() {
                login('m711kart', 'Ma775672439#');
            };
            document.body.appendChild(testBtn);

            console.log('=== انتهاء تحميل الموقع ===');
        });
    </script>
</body>
</html>
